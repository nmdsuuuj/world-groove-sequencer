# Appendix: Future Extensions / 将来拡張アイデア集

この付録は、現時点では **「将来的に実装したい / 拡張機能候補」** として
アイデアレベル・設計レベルにとどめているものをまとめたものです。

記号の意味（実現可能性のざっくり評価）:

- ◎ … 実装容易〜中程度。現行設計とよく噛み合う。
- ○ … 現実的だが開発コストがそれなりにかかる。
- △ … 研究寄り。試作や別プロジェクトでの検証を推奨。

---

## 1. コード / スケールトラック系

### 1-1. コードトラックによるスケール拘束（ハーモニー制御）

- **概要**  
  ソングモードに「コードトラック」を追加し、  
  各小節ごとのコード or スケール情報を持たせる。  
  メロディ・ベースなどのノート系トラックは、  
  この情報に従って音階を補正（スケール内に収める）できる。

- **動作イメージ**
  - コードトラック:  
    - 例：`[Cmin, Cmin, Fmin, G7, ...]` のような列。  
  - 各ノートは「スケール外」だった場合、  
    最も近いスケール内音に寄せる / テーブルでマッピングする。
  - コードトラックをミュートすると拘束を解除できる。

- **実現可能性**: **○**  
  - 音楽理論としてはシンプル。  
  - ただし UI・ワークフロー設計（どのタイミングでコード編集するか）が必要。  
  - 既存データ構造（Pattern / LiveTake / SongStructure）には  
    追加フィールドで自然に乗せられる。

---

### 1-2. 簡易版: 「上下方向のピッチシフトトラック」

- **概要**  
  コードトラックが難しければ、まずは  
  「この小節だけ +2 半音」「ここだけ -5 半音」といった  
  **相対トランスポーズトラック**から始める。

- **動作イメージ**
  - `transposeTrack` というソング用トラックを持つ。  
  - 各セクションに `+0, +2, -5, ...` の値を与える。  
  - 対象トラックのノートは、出力前にその値だけシフトされる。

- **実現可能性**: **◎**  
  - 実装は非常に簡単。  
  - ハーモニー感はシンプルだが、ミニマルな音楽には十分面白い。  
  - 将来のコードトラックへの足がかりとして優秀。

---

## 2. Live Take 拡張

### 2-1. Live Take の「パターン昇格（Promote to Pattern）」

- **概要**  
  Live Take で録音したフレーズがあまりにも良かった場合、  
  それを **通常の 2 小節パターン + オーナメント** に昇格させる機能。

- **動作イメージ**
  - ボタン例：`Promote to Pattern`  
  - LiveNote 列から 2 小節分を切り出し、  
    近いグリッドにスナップさせた上で Pattern/Step/Ornament に変換。
  - 以後はオーナメント編集などの「フル機能」で弄れる。

- **実現可能性**: **○**  
  - アルゴリズム側は「ノートをステップに割り当てる」ロジックが必要。  
  - UI 的には「どこを 2 小節として切るか」を決める操作が必要。

---

### 2-2. Live Take の逆再生・半速 / 倍速

- **概要**  
  今の仕様では Live Take に対して  
  timeScale（0.5x / 1x / 2x）やシフトは想定済み。  
  拡張案として：  
  - 逆再生（time を反転）  
  - 極端な timeScale（0.25x, 4x など）

- **実現可能性**: **◎**  
  - データ構造的には、LiveNote.time の変換だけで済む。  
  - オーディオエンジン側の負荷もほぼ増えない。

---

### 2-3. Live Take 同士のブレンド

- **概要**  
  2 つの Live Take の間をフェーダーでモーフィングする。  
  - 例：`LT_A` と `LT_B` を選び、  
    中央フェーダーで中間状態（ノートのタイム/ピッチ補間）を作る。

- **実現可能性**: **△**  
  - 音楽的にかなり面白いが、  
    ノート数 / タイミングのマッチングが必要でロジックが重い。  
  - 実験的な別モードとして実装するほうが現実的。

---

## 3. オーナメント系拡張

### 3-1. 民俗音楽系オーナメント・プリセット大規模ライブラリ

- **概要**  
  いまは「変態テンプレート」を中心に想定しているが、  
  将来的には世界中の民俗音楽・古典音楽にインスパイアされた  
  **オーナメントプリセット集（JSON ライブラリ）** を増やしていく。

- **カテゴリ例**
  - インド古典（ガマカ、ターン、ティハイ etc.）  
  - アラブ／トルコ系装飾  
  - アイルランド / スコットランド系フィドル・オーナメント  
  - ブラジル / ラテン系打楽器の装飾フレーズ  
  - 雅楽・声明・南インドボーカル由来のメロディ装飾 など

- **実現可能性**: **◎**（コンテンツ制作の手間は大）  
  - 技術的には JSON を増やすだけなので容易。  
  - ただし音楽的な分析とプリセット作成に時間がかかる。

---

### 3-2. オーナメントの「自動生成アシスタント」

- **概要**  
  ユーザーがベースのフレーズを弾くと、  
  Rhythm / Scale / Style の指定に基づいて  
  自動的に候補オーナメントを提案してくれる機能。

- **実現可能性**: **△**  
  - ルールベースなら ○ だが、  
    「世界中のスタイルを学習した自動オーナメント」は ML 寄りで研究要素が強い。  
  - 最初は手動プリセット + ランダム変形レベルから始め、  
    余裕があれば ML モデル連携を検討、が現実的。

---

## 4. グルーヴ / 時間構造の拡張

### 4-1. ユーザー演奏からグルーヴを抽出する「Groove Capture」

- **概要**  
  ユーザーがパッドや鍵盤で叩いたタイミングから  
  グルーヴテーブル（オフセット値）を抽出し、  
  `groove_library` に保存する機能。

- **実現可能性**: **○**  
  - 技術的には「基準グリッドとの差分を統計化」するだけなので現実的。  
  - UI 的には「Groove REC モード」+「適用先レーン選択」が必要。

---

### 4-2. 拍の中の「変則分割フェーダー」強化

- **概要**  
  既にアイデアとしてある  
  「キックは 4 つ打ちのまま、ハットだけ拍内を 3 / 5 / 7 分割等でフェーダー切替」  
  を、さらにテンプレ化して拡張する。

- **やりたいこと**
  - 1 拍を 2 / 3 / 4 / 5 / 7 / 9 分割等にして、  
    フェーダーで段階的に切り替え。  
  - 特定レーンにだけ適用できる「prime division engine」。

- **実現可能性**: **◎**  
  - ステップ生成ロジックを作ってプリセット化すれば OK。  
  - すでに基本コンセプトの一部として想定しているので拡張は自然。

---

## 5. ソング / 構成系拡張

### 5-1. セクションベースのフォーム管理（A/B/C/Bridge 等）

- **概要**  
  ソングモードに「セクション名」「カラー」を持たせて、  
  Aセクション / Bセクション / ブリッジ / ブレイク などを  
  視覚的に管理できるようにする。

- **実現可能性**: **◎**  
  - 既存の SongSection に name / color を足すだけ。  
  - UI のタイムライン表示で色分けする。  

---

### 5-2. マクロ的なフォームプリセット（構成テンプレート）

- **概要**  
  `Intro - A - A - B - A - Break - A` のような、  
  フォームのプリセットをロードしてから、  
  その枠にパターンや Live Take を埋めていくモード。

- **実現可能性**: **○**  
  - SongStructure を生成するテンプレート関数があれば実装可能。  
  - 音楽的には DAW のアレンジメントテンプレに近い。

---

## 6. UI / 体験系拡張

### 6-1. マルチユーザー / ネットワーク・ジャム

- **概要**  
  複数端末から同じプロジェクトにアクセスし、  
  各自が別トラックを担当したり、  
  Live Take / オーナメントを投げ合うリアルタイムセッション機能。

- **実現可能性**: **△**  
  - ネットワーク同期（レイテンシ、コンフリクト処理）が難所。  
  - 別サービスとして切り出すほうが良いレベルの規模感。

---

### 6-2. 「ヒストリー／メモリー」的な音のスタック

- **概要**  
  気に入った Live Take / Pattern / Ornament を  
  タイムラインとは別の「スタック」にどんどん溜めていき、  
  あとからランダムまたはタグ別に呼び出せる機能。

- **実現可能性**: **○**  
  - データ構造としては単なる別コレクション。  
  - UI の設計（どう見せるか）がポイント。  
  - あなたの「テキトーに保存して、あとで掘り返す」スタイルに合う。

---

## 7. 検索・タグ・推薦系

### 7-1. 自動タグ付け / サウンド特徴の自動分析

- **概要**  
  ユーザーは「ファイル名や文字情報に頼りたくない」という方針。  
  将来的には、音の特徴（密度・リズムの粗さ・ピッチの動きなど）を解析し、  
  類似フレーズ検索や自動タグ付けを行う可能性がある。

- **実現可能性**: **○〜△**  
  - テンポ / ノート密度 / ピッチレンジ程度なら ○。  
  - 「これはAmapianoっぽい」などスタイル分類まで行くと △（MLが必要）。  
  - オンライン / オフライン処理をどう分けるかの設計も必要。

---

### 7-2. 「次にこれどう？」系のパターン推薦

- **概要**  
  現在鳴っているパターンや Live Take に基づいて、  
  「次にこんなパターンを挿し替えると面白そう」といった  
  Recomender 的なサジェスト機能。

- **実現可能性**: **△**  
  - ルールベースで簡易版は作れるが、  
    本気の推薦システムはデータと検証が必要。  
  - 別プロジェクト or 研究テーマとして扱うのが現実的。

---

## 8. エクスポート / 他ツール連携

### 8-1. MIDI エクスポート（Pattern / Live Take → MIDI）

- **概要**  
  Pattern / Live Take を SMF (Standard MIDI File) に変換し、  
  DAW や他のシーケンサーで使えるようにする。

- **実現可能性**: **◎**  
  - LiveNote 列をそのまま MIDI ノートに変換するだけ。  
  - 実装は既存ライブラリを使えばかなり簡単。  

---

### 8-2. Ableton / Bitwig などへの専用エクスポート

- **概要**  
  クリップ / パターン単位で Ableton Live, Bitwig Studio などに渡す形式を用意する。

- **実現可能性**: **○**  
  - 各 DAW の API / ファイル形式に依存する。  
  - まずは汎用 MIDI → 後から DAW 別テンプレートという流れが現実的。

---

## 9. AI 連携（超長期構想）

### 9-1. 「世界グルーヴ図書館」とのオンライン同期

- **概要**  
  オーナメント / グルーヴ / パターンをオンラインライブラリと同期し、  
  他ユーザーと共有・交換できるようにする。

- **実現可能性**: **△**  
  - サーバー / 認証 / ストレージ設計が必要。  
  - 別サービス化したうえでクライアントとしてこのアプリが接続する形がよさそう。

---

### 9-2. 会話型アシスタントによる「モード設計」

- **概要**  
  ChatGPT のようなアシスタントに  
  「もっと○○風に」「インド古典＋Amapianoの中間を」などと指示して、  
  オーナメントやグルーヴのパラメータを自動でチューニングしてもらう機能。

- **実現可能性**: **△**  
  - 技術的には API 経由でやり取り可能だが、  
    プロンプト設計と結果の安定性確保が課題。  
  - 実験的 / 外部ツール的な位置づけが現実的。

---

この付録は、「今すぐ全部やる」のではなく、  
**どこまでが本体 v1 / v2 の範囲で、どこから先が夢・研究なのか** を整理するためのメモです。  
実装フェーズでは、まず本体仕様（オーナメント + Live Take + Swap + Groove）を優先し、  
ここに挙げた拡張は「体力と時間があるときのご褒美」として扱うのがよさそうです。
